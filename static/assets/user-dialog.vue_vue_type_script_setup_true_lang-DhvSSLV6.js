import{d as e,c as a,a as s,r,w as l,y as t,f as u,z as i,p as d,u as o,k as n,h as m,l as p,dp as _,aQ as v,dq as g,n as c}from"./index-DxSWhjl1.js";/* empty css                  *//* empty css                   *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                 *//* empty css                */import{E as f,a as b}from"./index-WiqLJQME.js";import{E as w}from"./index-CRXlpzmM.js";import{E as V}from"./index-D-zLU9MD.js";import{E as y}from"./index-Bh_mQ9x7.js";import{E as j}from"./index-CJAV6PHc.js";const D={class:"dialog-footer"},h=e({__name:"user-dialog",props:{visible:{type:Boolean},type:{},userData:{}},emits:["update:visible","submit"],setup(e,{emit:h}){const x=e,I=h,q=a({get:()=>x.visible,set:e=>I("update:visible",e)}),E=a(()=>x.type),U=s(),k=r({username:"",password:"",netease_user_id:"",is_admin:"0",status:"0"}),O=a(()=>{const e={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}]};return"add"===E.value?(e.password=[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:20,message:"长度在 6 到 20 个字符",trigger:"blur"}],e.netease_user_id=[{required:!0,message:"请输入网易云用户ID",trigger:"blur"},{pattern:/^\d+$/,message:"网易云ID只能是数字",trigger:"blur"}]):(e.password=[{required:!1,message:"请输入密码",trigger:"blur"}],e.netease_user_id=[{required:!1,message:"请输入网易云用户ID",trigger:"blur"},{pattern:/^\d+$/,message:"网易云ID只能是数字",trigger:"blur"}]),e});l(()=>[x.visible,x.type,x.userData],([e])=>{var a,s,r,l,t;e&&("add"===E.value?Object.assign(k,{username:"",password:"",netease_user_id:"",is_admin:"0",status:"0"}):Object.assign(k,{username:(null==(a=x.userData)?void 0:a.username)||"",password:"",netease_user_id:(null==(s=x.userData)?void 0:s.netease_user_id)||"",is_admin:(null==(l=null==(r=x.userData)?void 0:r.is_admin)?void 0:l.toString())||"0",status:(null==(t=x.userData)?void 0:t.status)||"0"}),c(()=>{var e;null==(e=U.value)||e.clearValidate()}))},{immediate:!0});const P=()=>{return e=null,a=null,s=function*(){var e;if(U.value)try{if(yield U.value.validate(),"add"===E.value){const e={username:k.username,password:k.password,netease_user_id:k.netease_user_id,is_admin:parseInt(k.is_admin)};yield _(e),v.success("添加成功")}else if("edit"===E.value&&(null==(e=x.userData)?void 0:e.id)){const e={username:k.username,is_admin:parseInt(k.is_admin),status:parseInt(k.status)};k.password&&(e.password=k.password),void 0!==k.netease_user_id&&(e.netease_user_id=k.netease_user_id),yield g(x.userData.id,e),v.success("更新成功")}q.value=!1,I("submit")}catch(a){const e=a.message||a.msg||("add"===E.value?"添加失败":"更新失败");v.error(e)}},new Promise((r,l)=>{var t=e=>{try{i(s.next(e))}catch(a){l(a)}},u=e=>{try{i(s.throw(e))}catch(a){l(a)}},i=e=>e.done?r(e.value):Promise.resolve(e.value).then(t,u);i((s=s.apply(e,a)).next())});var e,a,s};return(e,a)=>{const s=w,r=b,l=V,_=f,v=y,g=j;return u(),t(g,{modelValue:q.value,"onUpdate:modelValue":a[6]||(a[6]=e=>q.value=e),title:"add"===E.value?"添加用户":"修改用户信息",width:"40%","align-center":""},{footer:i(()=>[m("div",D,[d(v,{onClick:a[5]||(a[5]=e=>q.value=!1)},{default:i(()=>[...a[7]||(a[7]=[p("取消",-1)])]),_:1}),d(v,{type:"primary",onClick:P},{default:i(()=>[...a[8]||(a[8]=[p("提交",-1)])]),_:1})])]),default:i(()=>[d(_,{ref_key:"formRef",ref:U,model:o(k),rules:O.value,"label-width":"100px"},{default:i(()=>[d(r,{label:"用户名",prop:"username"},{default:i(()=>[d(s,{modelValue:o(k).username,"onUpdate:modelValue":a[0]||(a[0]=e=>o(k).username=e),placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),d(r,{label:"密码",prop:"password"},{default:i(()=>[d(s,{modelValue:o(k).password,"onUpdate:modelValue":a[1]||(a[1]=e=>o(k).password=e),type:"password",placeholder:"请输入密码"},null,8,["modelValue"])]),_:1}),d(r,{label:"网易云ID",prop:"netease_user_id"},{default:i(()=>[d(s,{modelValue:o(k).netease_user_id,"onUpdate:modelValue":a[2]||(a[2]=e=>o(k).netease_user_id=e),placeholder:"请输入网易云ID"},null,8,["modelValue"])]),_:1}),d(r,{label:"管理员",prop:"is_admin"},{default:i(()=>[d(l,{modelValue:o(k).is_admin,"onUpdate:modelValue":a[3]||(a[3]=e=>o(k).is_admin=e),"active-value":"1","inactive-value":"0"},null,8,["modelValue"])]),_:1}),"edit"===E.value?(u(),t(r,{key:0,label:"状态",prop:"status"},{default:i(()=>[d(l,{modelValue:o(k).status,"onUpdate:modelValue":a[4]||(a[4]=e=>o(k).status=e),"active-value":"0","inactive-value":"1"},null,8,["modelValue"])]),_:1})):n("",!0)]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}}});export{h as _};
