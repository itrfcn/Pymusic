var e=Object.defineProperty,a=Object.defineProperties,t=Object.getOwnPropertyDescriptors,i=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,s=(a,t,i)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[t]=i,o=(e,a)=>{for(var t in a||(a={}))l.call(a,t)&&s(e,t,a[t]);if(i)for(var t of i(a))r.call(a,t)&&s(e,t,a[t]);return e};import{d as p,a as d,c as n,w as m,y as u,f as c,z as v,p as y,u as b,h as f,l as j,bb as _,aQ as g,bc as x}from"./index-DxSWhjl1.js";/* empty css                *//* empty css              *//* empty css                */import{E as h,a as O}from"./index-WiqLJQME.js";import{E as V}from"./index-CRXlpzmM.js";import{E as w}from"./index-Bh_mQ9x7.js";import{E as P}from"./index-CJAV6PHc.js";import{_ as D}from"./_plugin-vue_export-helper-BCo6x5W8.js";import"./index-B4YNvkKg.js";import"./index-BdUhC8Rj.js";import"./castArray-CTnnYyy2.js";import"./index-DpIcWAeA.js";import"./_initCloneObject-CnmkLFFW.js";import"./event-BwRzfsZt.js";import"./aria-Dle50h-X.js";import"./index-DqeJCCY1.js";import"./vnode-D3WqlgwN.js";import"./index-B5405CIA.js";import"./use-dialog-DNz0WzI-.js";import"./refs-Cw5r5QN8.js";const E={class:"dialog-footer"};var C,U;const k=D(p((C=o({},{name:"PlaylistDialog"}),U={__name:"playlist-dialog",props:{visible:{type:Boolean},type:{},playlistData:{}},emits:["update:visible","submit"],setup(e,{emit:a}){const t=e,i=a,l=d(),r=n({get:()=>t.visible,set:e=>i("update:visible",e)}),s=n(()=>t.type),p=d({playlist_id:"",name:"",description:"",username:"",create_time:"",update_time:""}),D={name:[{required:!0,message:"请输入歌单名称",trigger:"blur"},{min:1,max:50,message:"歌单名称长度在 1 到 50 个字符",trigger:"blur"}],description:[{max:200,message:"歌单描述不能超过 200 个字符",trigger:"blur"}]};m(()=>t.visible,e=>{e?C():U()},{immediate:!0}),m(()=>t.playlistData,e=>{e&&t.visible&&C()},{deep:!0});const C=()=>{"add"===s.value?Object.assign(p.value,{playlist_id:"",name:"",description:"",username:"",create_time:"",update_time:""}):"edit"===s.value&&t.playlistData&&Object.assign(p.value,o({},t.playlistData))},U=()=>{var e;p.value={playlist_id:"",name:"",description:"",username:"",create_time:"",update_time:""},null==(e=l.value)||e.resetFields()},k=()=>{r.value=!1},I=()=>{return e=null,a=null,t=function*(){if(l.value)try{if(yield l.value.validate(),"add"===s.value){const e={name:p.value.name,description:p.value.description,creator_id:1};yield _(e),g.success("添加歌单成功")}else if("edit"===s.value){if(!p.value.playlist_id)return void g.error("歌单ID不存在");const e={name:p.value.name,description:p.value.description};yield x(Number(p.value.playlist_id),e),g.success("更新歌单成功")}r.value=!1,i("submit")}catch(e){g.error("操作失败："+(e.msg||e.message||"未知错误"))}},new Promise((i,l)=>{var r=e=>{try{o(t.next(e))}catch(a){l(a)}},s=e=>{try{o(t.throw(e))}catch(a){l(a)}},o=e=>e.done?i(e.value):Promise.resolve(e.value).then(r,s);o((t=t.apply(e,a)).next())});var e,a,t};return(e,a)=>(c(),u(b(P),{modelValue:r.value,"onUpdate:modelValue":a[2]||(a[2]=e=>r.value=e),title:"add"===s.value?"添加歌单":"编辑歌单",width:"500px",onClose:k},{footer:v(()=>[f("span",E,[y(b(w),{onClick:k},{default:v(()=>[...a[3]||(a[3]=[j("取消",-1)])]),_:1}),y(b(w),{type:"primary",onClick:I},{default:v(()=>[...a[4]||(a[4]=[j("确定",-1)])]),_:1})])]),default:v(()=>[y(b(h),{ref_key:"playlistFormRef",ref:l,model:p.value,rules:D,"label-position":"top","label-width":"80px",size:"large"},{default:v(()=>[y(b(O),{label:"歌单名称",prop:"name"},{default:v(()=>[y(b(V),{modelValue:p.value.name,"onUpdate:modelValue":a[0]||(a[0]=e=>p.value.name=e),placeholder:"请输入歌单名称"},null,8,["modelValue"])]),_:1}),y(b(O),{label:"歌单描述",prop:"description"},{default:v(()=>[y(b(V),{modelValue:p.value.description,"onUpdate:modelValue":a[1]||(a[1]=e=>p.value.description=e),type:"textarea",rows:3,placeholder:"请输入歌单描述"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]))}},a(C,t(U)))),[["__scopeId","data-v-5d55dd1b"]]);export{k as default};
