var e=Object.defineProperty,a=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,s=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t;import{d as r,s as o,aG as n,a as d,c as u,w as c,y as i,f as h,z as m,p,aC as f,u as v,h as k,e as y,m as g,l as b,F as C,aQ as j}from"./index-DxSWhjl1.js";/* empty css                  *//* empty css                   *//* empty css                  *//* empty css                     *//* empty css                    */import{E as x}from"./index-BdOifhfF.js";import{E as _}from"./index-Boro3eJa.js";import{E}from"./index-Bh_mQ9x7.js";import{E as K}from"./index-CJAV6PHc.js";const O={style:{display:"flex","align-items":"center"}},V={key:0},w={key:1},M=r({__name:"role-permission-dialog",props:{modelValue:{type:Boolean,default:!1},roleData:{default:void 0}},emits:["update:modelValue","success"],setup(e,{emit:r}){const M=e,$=r,{menuList:L}=o(n()),P=d(),H=d(!0),A=d(!1),D=u({get:()=>M.modelValue,set:e=>$("update:modelValue",e)}),N=u(()=>{const e=r=>{var o,n;const d=((e,r)=>{for(var o in r||(r={}))l.call(r,o)&&s(e,o,r[o]);if(a)for(var o of a(r))t.call(r,o)&&s(e,o,r[o]);return e})({},r);if(null==(n=null==(o=r.meta)?void 0:o.authList)?void 0:n.length){const e=r.meta.authList.map(e=>({id:`${r.id}_${e.authMark}`,name:`${r.name}_${e.authMark}`,label:e.title,authMark:e.authMark,isAuth:!0,checked:e.checked||!1}));d.children=d.children?[...d.children,...e]:e}return d.children&&(d.children=d.children.map(e)),d};return L.value.map(e)}),Q={children:"children",label:e=>{var a;return f(null==(a=e.meta)?void 0:a.title)||e.label||""}};c(()=>M.modelValue,e=>{e&&M.roleData});const S=()=>{var e;D.value=!1,null==(e=P.value)||e.setCheckedKeys([])},z=()=>{j.success("权限保存成功"),$("success"),S()},B=()=>{const e=P.value;if(!e)return;const a=e.store.nodesMap;Object.values(a).forEach(e=>{e.expanded=!H.value}),H.value=!H.value},F=()=>{const e=P.value;if(e){if(A.value)e.setCheckedKeys([]);else{const a=G(N.value);e.setCheckedKeys(a)}A.value=!A.value}},G=e=>{const a=[],l=e=>{e.forEach(e=>{var t;e.name&&a.push(e.name),(null==(t=e.children)?void 0:t.length)&&l(e.children)})};return l(e),a},I=()=>{const e=P.value;if(!e)return;const a=e.getCheckedKeys(),l=G(N.value);A.value=a.length===l.length&&l.length>0},R=()=>{const e=P.value;if(!e)return;e.getCheckedKeys(),e.getHalfCheckedKeys(),e.getCheckedNodes(),e.getHalfCheckedNodes();const a=e.getCheckedKeys().length;e.getHalfCheckedKeys().length;j.success(`已输出选中数据到控制台，共选中 ${a} 个节点`)};return(e,a)=>{const l=_,t=x,s=E,r=K;return h(),i(r,{modelValue:v(D),"onUpdate:modelValue":a[0]||(a[0]=e=>C(D)?D.value=e:null),title:"菜单权限",width:"520px","align-center":"",class:"el-dialog-border",onClose:S},{footer:m(()=>[p(s,{onClick:R,style:{"margin-left":"8px"}},{default:m(()=>[...a[1]||(a[1]=[b("获取选中数据",-1)])]),_:1}),p(s,{onClick:B},{default:m(()=>[b(g(v(H)?"全部收起":"全部展开"),1)]),_:1}),p(s,{onClick:F,style:{"margin-left":"8px"}},{default:m(()=>[b(g(v(A)?"取消全选":"全部选择"),1)]),_:1}),p(s,{type:"primary",onClick:z},{default:m(()=>[...a[2]||(a[2]=[b("保存",-1)])]),_:1})]),default:m(()=>[p(t,{height:"70vh"},{default:m(()=>[p(l,{ref_key:"treeRef",ref:P,data:v(N),"show-checkbox":"","node-key":"name","default-expand-all":v(H),"default-checked-keys":[1,2,3],props:Q,onCheck:I},{default:m(({data:e})=>[k("div",O,[e.isAuth?(h(),y("span",V,g(e.label),1)):(h(),y("span",w,g(Q.label(e)),1))])]),_:1},8,["data","default-expand-all"])]),_:1})]),_:1},8,["modelValue"])}}});export{M as _};
