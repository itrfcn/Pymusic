var e=Object.defineProperty,a=Object.defineProperties,t=Object.getOwnPropertyDescriptors,i=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,s=(a,t,i)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[t]=i,o=(e,a)=>{for(var t in a||(a={}))r.call(a,t)&&s(e,t,a[t]);if(i)for(var t of i(a))l.call(a,t)&&s(e,t,a[t]);return e};import{d as p,a as d,c as n,w as m,y as u,f as c,z as v,p as b,u as f,h as y,l as j,bb as _,aQ as g,bc as x}from"./index-DtLPO4VG.js";/* empty css                *//* empty css              *//* empty css                */import{E as h,a as O}from"./index-Rg8GWnlI.js";import{E as w}from"./index-DbLJzq82.js";import{E as P}from"./index-B1oc1BI_.js";import{E as V}from"./index-7btWiO1t.js";import{_ as D}from"./_plugin-vue_export-helper-BCo6x5W8.js";import"./index-Dw6dGDDE.js";import"./index-B-FCdvUf.js";import"./castArray-BDKD0Zvx.js";import"./index-CP_mWmfc.js";import"./_initCloneObject-BaiE7a9Y.js";import"./event-BwRzfsZt.js";import"./aria-Dle50h-X.js";import"./index-ClKRQ_I3.js";import"./vnode-C8cdOOkd.js";import"./index-BrpO1YGF.js";import"./use-dialog-BBStnoor.js";import"./refs-Cw5r5QN8.js";const E={class:"dialog-footer"};var U,C;const I=D(p((U=o({},{name:"PlaylistDialog"}),C={__name:"playlist-dialog",props:{visible:{type:Boolean},type:{},playlistData:{}},emits:["update:visible","submit"],setup(e,{emit:a}){const t=e,i=a,r=d(),l=n({get:()=>t.visible,set:e=>i("update:visible",e)}),s=n(()=>t.type),p=d({id:"",name:"",description:"",creator_id:"",creator_name:"",create_time:"",update_time:""}),D={name:[{required:!0,message:"请输入歌单名称",trigger:"blur"},{min:1,max:50,message:"歌单名称长度在 1 到 50 个字符",trigger:"blur"}],description:[{max:200,message:"歌单描述不能超过 200 个字符",trigger:"blur"}]};m(()=>t.visible,e=>{e?U():C()},{immediate:!0}),m(()=>t.playlistData,e=>{e&&t.visible&&U()},{deep:!0});const U=()=>{"add"===s.value?Object.assign(p.value,{id:"",name:"",description:"",creator_id:"",creator_name:"",create_time:"",update_time:""}):"edit"===s.value&&t.playlistData&&Object.assign(p.value,o({},t.playlistData))},C=()=>{var e;p.value={id:"",name:"",description:"",creator_id:"",creator_name:"",create_time:"",update_time:""},null==(e=r.value)||e.resetFields()},I=()=>{l.value=!1},k=()=>{return e=null,a=null,t=function*(){if(r.value)try{if(yield r.value.validate(),"add"===s.value){const e={name:p.value.name,description:p.value.description,creator_id:1};yield _(e),g.success("添加歌单成功")}else if("edit"===s.value){if(!p.value.id)return void g.error("歌单ID不存在");const e={name:p.value.name,description:p.value.description};yield x(Number(p.value.id),e),g.success("更新歌单成功")}l.value=!1,i("submit")}catch(e){g.error("操作失败："+(e.msg||e.message||"未知错误"))}},new Promise((i,r)=>{var l=e=>{try{o(t.next(e))}catch(a){r(a)}},s=e=>{try{o(t.throw(e))}catch(a){r(a)}},o=e=>e.done?i(e.value):Promise.resolve(e.value).then(l,s);o((t=t.apply(e,a)).next())});var e,a,t};return(e,a)=>(c(),u(f(V),{modelValue:l.value,"onUpdate:modelValue":a[2]||(a[2]=e=>l.value=e),title:"add"===s.value?"添加歌单":"编辑歌单",width:"500px",onClose:I},{footer:v(()=>[y("span",E,[b(f(P),{onClick:I},{default:v(()=>[...a[3]||(a[3]=[j("取消",-1)])]),_:1}),b(f(P),{type:"primary",onClick:k},{default:v(()=>[...a[4]||(a[4]=[j("确定",-1)])]),_:1})])]),default:v(()=>[b(f(h),{ref_key:"playlistFormRef",ref:r,model:p.value,rules:D,"label-position":"top","label-width":"80px",size:"large"},{default:v(()=>[b(f(O),{label:"歌单名称",prop:"name"},{default:v(()=>[b(f(w),{modelValue:p.value.name,"onUpdate:modelValue":a[0]||(a[0]=e=>p.value.name=e),placeholder:"请输入歌单名称"},null,8,["modelValue"])]),_:1}),b(f(O),{label:"歌单描述",prop:"description"},{default:v(()=>[b(f(w),{modelValue:p.value.description,"onUpdate:modelValue":a[1]||(a[1]=e=>p.value.description=e),type:"textarea",rows:3,placeholder:"请输入歌单描述"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]))}},a(U,t(C)))),[["__scopeId","data-v-5b158340"]]);export{I as default};
