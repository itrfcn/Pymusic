var e=Object.defineProperty,a=Object.defineProperties,t=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,s=(a,t,o)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[t]=o,l=(e,a)=>{for(var t in a||(a={}))r.call(a,t)&&s(e,t,a[t]);if(o)for(var t of o(a))i.call(a,t)&&s(e,t,a[t]);return e},n=(e,o)=>a(e,t(o));import{x as p,D as d,bd as m,s as u,d as c,c as j,e as h,f,y as _,k as g,u as v,z as b,p as x,a3 as y,am as k,h as w,g as C,m as O,a as P,E as S,G as T,a2 as V,F as A,l as E,$ as B,be as R,aQ as z}from"./index-DxSWhjl1.js";import{E as D}from"./el-card-CxrJQUwV.js";import{_ as F}from"./index-SZqK-YiV.js";import{_ as U}from"./useTableColumns-DRhLfddV.js";import{E as M}from"./el-space-18I_yB0Z.js";/* empty css                  */import{u as N}from"./useTable-CJG2NXTU.js";import{b as W,a as I,E as L}from"./el-dropdown-item-BQzRcAOp.js";/* empty css                  *//* empty css                     */import{_ as Q}from"./index.vue_vue_type_script_setup_true_lang-VvwPD4Pm.js";import{_ as $}from"./index.vue_vue_type_script_setup_true_lang-DIY7jIPu.js";import{_ as G}from"./role-search.vue_vue_type_script_setup_true_lang-C9j4knnW.js";import{_ as H}from"./role-edit-dialog.vue_vue_type_script_setup_true_lang-R-o1UONi.js";import{_ as X}from"./role-permission-dialog.vue_vue_type_script_setup_true_lang-VAUFa1Lc.js";import"./tree-select-DefJVcvz.js";import{a as q}from"./message-box-B9816q0a.js";/* empty css              *//* empty css                */import{E as J}from"./index-Bh_mQ9x7.js";import{E as K}from"./el-option-Cunb9zja.js";/* empty css                  *//* empty css                 *//* empty css                    *//* empty css                   */import"./el-empty-BI85Vzrg.js";import"./index-BdUhC8Rj.js";import"./index-BdOifhfF.js";import"./index-DpIcWAeA.js";import"./index-CD_r_rq4.js";import"./index-B5405CIA.js";import"./aria-Dle50h-X.js";import"./index-B4YNvkKg.js";import"./_initCloneObject-CnmkLFFW.js";import"./el-radio-g-Zqyaif.js";import"./event-BwRzfsZt.js";import"./castArray-CTnnYyy2.js";import"./debounce-Lel90vLM.js";import"./index-D0y5PuVQ.js";import"./index-BDfTIPIJ.js";import"./index-CRXlpzmM.js";import"./_plugin-vue_export-helper-BCo6x5W8.js";import"./vnode-D3WqlgwN.js";import"./refs-Cw5r5QN8.js";import"./index-baS9l8Oy.js";/* empty css                     */import"./el-row-BbFCgjqK.js";import"./el-col-ZA0CGZf_.js";import"./index-WiqLJQME.js";import"./index-Bn9cuIqS.js";import"./index-DrgPkUCe.js";import"./index-D-zLU9MD.js";import"./validator-Cq7xwYaP.js";import"./index-CFBlNhx4.js";/* empty css                  *//* empty css                   *//* empty css                  */import"./index-CJAV6PHc.js";import"./index-DqeJCCY1.js";import"./use-dialog-DNz0WzI-.js";import"./index-Boro3eJa.js";import"./token-DWNpOE8r.js";import"./index-DBG9R7L1.js";const Y=p(),Z=c(n(l({},{name:"ArtButtonMore"}),{__name:"index",props:{list:{},auth:{}},emits:["click"],setup(e,{emit:a}){const{hasAuth:t}=(()=>{var e;const a=d(),{isFrontendMode:t}=m(),{info:o}=u(Y),r=1===(null==(e=o.value)?void 0:e.is_admin)?["add","edit","delete","view"]:[],i=Array.isArray(a.meta.authList)?a.meta.authList:[];return{hasAuth:e=>t.value?r.includes(e):i.some(a=>(null==a?void 0:a.authMark)===e)}})(),o=e,r=j(()=>o.list.some(e=>!e.auth||t(e.auth))),i=a;return(a,o)=>{const s=$,l=Q,n=I,p=W,d=L;return f(),h("div",null,[v(r)?(f(),_(d,{key:0},{dropdown:b(()=>[x(p,null,{default:b(()=>[(f(!0),h(y,null,k(e.list,e=>(f(),h(y,{key:e.key},[!e.auth||v(t)(e.auth)?(f(),_(n,{key:0,disabled:e.disabled,onClick:a=>(e=>{i("click",e)})(e)},{default:b(()=>[w("div",{class:"flex-c gap-2",style:C({color:e.color})},[e.icon?(f(),_(l,{key:0,icon:e.icon},null,8,["icon"])):g("",!0),w("span",null,O(e.label),1)],4)]),_:2},1032,["disabled","onClick"])):g("",!0)],64))),128))]),_:1})]),default:b(()=>[x(s,{icon:"ri:more-2-fill",class:"!size-8 bg-g-200 dark:bg-g-300/45 text-sm"})]),_:1})):g("",!0)])}}})),ee={class:"art-full-height"},ae=c(n(l({},{name:"Role"}),{__name:"index",setup(e){const a=P({roleName:void 0,roleCode:void 0,description:void 0,enabled:void 0,daterange:void 0}),t=P(!1),s=P(!1),p=P(!1),d=P(void 0),{columns:m,columnChecks:u,data:c,loading:j,pagination:g,getData:y,searchParams:k,resetSearchParams:w,handleSizeChange:O,handleCurrentChange:W,refreshData:I}=N({core:{apiFn:R,apiParams:{current:1,size:20},excludeParams:["daterange"],columnsFactory:()=>[{prop:"roleId",label:"角色ID",width:100},{prop:"roleName",label:"角色名称",minWidth:120},{prop:"roleCode",label:"角色编码",minWidth:120},{prop:"description",label:"角色描述",minWidth:150,showOverflowTooltip:!0},{prop:"enabled",label:"角色状态",width:100,formatter:e=>{const a=e.enabled?{type:"success",text:"启用"}:{type:"warning",text:"禁用"};return B(K,{type:a.type},()=>a.text)}},{prop:"createTime",label:"创建日期",width:180,sortable:!0},{prop:"operation",label:"操作",width:80,fixed:"right",formatter:e=>B("div",[B(Z,{list:[{key:"permission",label:"菜单权限",icon:"ri:user-3-line"},{key:"edit",label:"编辑角色",icon:"ri:edit-2-line"},{key:"delete",label:"删除角色",icon:"ri:delete-bin-4-line",color:"#f56c6c"}],onClick:a=>Y(a,e)})])}]}}),L=P("add"),Q=(e,a)=>{s.value=!0,L.value=e,d.value=a},$=e=>{const a=e,{daterange:t}=a,s=((e,a)=>{var t={};for(var s in e)r.call(e,s)&&a.indexOf(s)<0&&(t[s]=e[s]);if(null!=e&&o)for(var s of o(e))a.indexOf(s)<0&&i.call(e,s)&&(t[s]=e[s]);return t})(a,["daterange"]),[p,d]=Array.isArray(t)?t:[null,null];Object.assign(k,n(l({},s),{startTime:p,endTime:d})),y()},Y=(e,a)=>{switch(e.key){case"permission":ae(a);break;case"edit":Q("edit",a);break;case"delete":te(a)}},ae=e=>{p.value=!0,d.value=e},te=e=>{q.confirm(`确定删除角色"${e.roleName}"吗？此操作不可恢复！`,"删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{z.success("删除成功"),I()}).catch(()=>{z.info("已取消删除")})};return(e,o)=>{const r=J,i=M,l=U,n=F,y=D,k=S("ripple");return f(),h("div",ee,[T(x(G,{modelValue:v(a),"onUpdate:modelValue":o[0]||(o[0]=e=>A(a)?a.value=e:null),onSearch:$,onReset:v(w)},null,8,["modelValue","onReset"]),[[V,v(t)]]),x(y,{class:"art-table-card",shadow:"never",style:C({"margin-top":v(t)?"12px":"0"})},{default:b(()=>[x(l,{columns:v(u),"onUpdate:columns":o[2]||(o[2]=e=>A(u)?u.value=e:null),showSearchBar:v(t),"onUpdate:showSearchBar":o[3]||(o[3]=e=>A(t)?t.value=e:null),loading:v(j),onRefresh:v(I)},{left:b(()=>[x(i,{wrap:""},{default:b(()=>[T((f(),_(r,{onClick:o[1]||(o[1]=e=>Q("add"))},{default:b(()=>[...o[6]||(o[6]=[E("新增角色",-1)])]),_:1})),[[k]])]),_:1})]),_:1},8,["columns","showSearchBar","loading","onRefresh"]),x(n,{loading:v(j),data:v(c),columns:v(m),pagination:v(g),"onPagination:sizeChange":v(O),"onPagination:currentChange":v(W)},null,8,["loading","data","columns","pagination","onPagination:sizeChange","onPagination:currentChange"])]),_:1},8,["style"]),x(H,{modelValue:v(s),"onUpdate:modelValue":o[4]||(o[4]=e=>A(s)?s.value=e:null),"dialog-type":v(L),"role-data":v(d),onSuccess:v(I)},null,8,["modelValue","dialog-type","role-data","onSuccess"]),x(X,{modelValue:v(p),"onUpdate:modelValue":o[5]||(o[5]=e=>A(p)?p.value=e:null),"role-data":v(d),onSuccess:v(I)},null,8,["modelValue","role-data","onSuccess"])])}}}));export{ae as default};
