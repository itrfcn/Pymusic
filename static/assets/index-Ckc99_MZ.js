var e=Object.defineProperty,a=Object.defineProperties,t=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,s=(a,t,o)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[t]=o,l=(e,a)=>{for(var t in a||(a={}))r.call(a,t)&&s(e,t,a[t]);if(o)for(var t of o(a))i.call(a,t)&&s(e,t,a[t]);return e},n=(e,o)=>a(e,t(o));import{x as p,D as d,bd as m,s as u,d as c,c as j,e as f,f as h,y as _,k as g,u as v,z as b,p as x,a3 as y,am as k,h as w,g as C,m as O,a as P,E as S,G as V,a2 as A,F as E,l as T,$ as z,be as B,aQ as D}from"./index-DtLPO4VG.js";import{E as R}from"./el-card-BIanTcix.js";import{_ as U}from"./index-DAWUdvV6.js";import{_ as F}from"./useTableColumns-CzKdEvSf.js";import{E as M}from"./el-space-DCQSY0Oj.js";/* empty css                  */import{u as N}from"./useTable-CZ1PsPko.js";import{b as W,a as I,E as L}from"./el-dropdown-item-hSqLg9mQ.js";/* empty css                  *//* empty css                     */import{_ as G}from"./index.vue_vue_type_script_setup_true_lang-B1k7ctHe.js";import{_ as Q}from"./index.vue_vue_type_script_setup_true_lang-DZW7fjpX.js";import{_ as K}from"./role-search.vue_vue_type_script_setup_true_lang-CyTZxRMb.js";import{_ as Z}from"./role-edit-dialog.vue_vue_type_script_setup_true_lang-Csqq8zar.js";import{_ as $}from"./role-permission-dialog.vue_vue_type_script_setup_true_lang-22Sbussn.js";import"./tree-select-v4UM_rlF.js";import{a as q}from"./message-box-fEnVxrsx.js";/* empty css              *//* empty css                */import{E as H}from"./index-B1oc1BI_.js";import{E as J}from"./el-option-Ov18kU7i.js";/* empty css                  *//* empty css                 *//* empty css                    *//* empty css                   */import"./el-empty-Bn1z00vH.js";import"./index-B-FCdvUf.js";import"./index-BbweI3YS.js";import"./index-CP_mWmfc.js";import"./index-DA2u0qjG.js";import"./index-BrpO1YGF.js";import"./aria-Dle50h-X.js";import"./index-Dw6dGDDE.js";import"./_initCloneObject-BaiE7a9Y.js";import"./el-radio-VjS3vhSd.js";import"./event-BwRzfsZt.js";import"./castArray-BDKD0Zvx.js";import"./debounce-ClIsgN62.js";import"./index-Dcq227u9.js";import"./index-Cw_vhjvW.js";import"./index-DbLJzq82.js";import"./_plugin-vue_export-helper-BCo6x5W8.js";import"./vnode-C8cdOOkd.js";import"./refs-Cw5r5QN8.js";import"./index-BFHcZp96.js";/* empty css                     */import"./el-row-DaT-_pz0.js";import"./el-col-Ki2JLbCA.js";import"./index-Rg8GWnlI.js";import"./index-Bbf00Op9.js";import"./index-EwWHi5tt.js";import"./index-D_yz80at.js";import"./validator-Wj-UOzUY.js";import"./index-iLZH01ON.js";/* empty css                  *//* empty css                   *//* empty css                  */import"./index-7btWiO1t.js";import"./index-ClKRQ_I3.js";import"./use-dialog-BBStnoor.js";import"./index-BIfVGNIa.js";import"./token-DWNpOE8r.js";import"./index-BedqjicC.js";const X=p(),Y=c(n(l({},{name:"ArtButtonMore"}),{__name:"index",props:{list:{},auth:{}},emits:["click"],setup(e,{emit:a}){const{hasAuth:t}=(()=>{var e;const a=d(),{isFrontendMode:t}=m(),{info:o}=u(X),r=1===(null==(e=o.value)?void 0:e.is_admin)?["add","edit","delete","view"]:[],i=Array.isArray(a.meta.authList)?a.meta.authList:[];return{hasAuth:e=>t.value?r.includes(e):i.some(a=>(null==a?void 0:a.authMark)===e)}})(),o=e,r=j(()=>o.list.some(e=>!e.auth||t(e.auth))),i=a;return(a,o)=>{const s=Q,l=G,n=I,p=W,d=L;return h(),f("div",null,[v(r)?(h(),_(d,{key:0},{dropdown:b(()=>[x(p,null,{default:b(()=>[(h(!0),f(y,null,k(e.list,e=>(h(),f(y,{key:e.key},[!e.auth||v(t)(e.auth)?(h(),_(n,{key:0,disabled:e.disabled,onClick:a=>(e=>{i("click",e)})(e)},{default:b(()=>[w("div",{class:"flex-c gap-2",style:C({color:e.color})},[e.icon?(h(),_(l,{key:0,icon:e.icon},null,8,["icon"])):g("",!0),w("span",null,O(e.label),1)],4)]),_:2},1032,["disabled","onClick"])):g("",!0)],64))),128))]),_:1})]),default:b(()=>[x(s,{icon:"ri:more-2-fill",class:"!size-8 bg-g-200 dark:bg-g-300/45 text-sm"})]),_:1})):g("",!0)])}}})),ee={class:"art-full-height"},ae=c(n(l({},{name:"Role"}),{__name:"index",setup(e){const a=P({roleName:void 0,roleCode:void 0,description:void 0,enabled:void 0,daterange:void 0}),t=P(!1),s=P(!1),p=P(!1),d=P(void 0),{columns:m,columnChecks:u,data:c,loading:j,pagination:g,getData:y,searchParams:k,resetSearchParams:w,handleSizeChange:O,handleCurrentChange:W,refreshData:I}=N({core:{apiFn:B,apiParams:{current:1,size:20},excludeParams:["daterange"],columnsFactory:()=>[{prop:"roleId",label:"角色ID",width:100},{prop:"roleName",label:"角色名称",minWidth:120},{prop:"roleCode",label:"角色编码",minWidth:120},{prop:"description",label:"角色描述",minWidth:150,showOverflowTooltip:!0},{prop:"enabled",label:"角色状态",width:100,formatter:e=>{const a=e.enabled?{type:"success",text:"启用"}:{type:"warning",text:"禁用"};return z(J,{type:a.type},()=>a.text)}},{prop:"createTime",label:"创建日期",width:180,sortable:!0},{prop:"operation",label:"操作",width:80,fixed:"right",formatter:e=>z("div",[z(Y,{list:[{key:"permission",label:"菜单权限",icon:"ri:user-3-line"},{key:"edit",label:"编辑角色",icon:"ri:edit-2-line"},{key:"delete",label:"删除角色",icon:"ri:delete-bin-4-line",color:"#f56c6c"}],onClick:a=>X(a,e)})])}]}}),L=P("add"),G=(e,a)=>{s.value=!0,L.value=e,d.value=a},Q=e=>{const a=e,{daterange:t}=a,s=((e,a)=>{var t={};for(var s in e)r.call(e,s)&&a.indexOf(s)<0&&(t[s]=e[s]);if(null!=e&&o)for(var s of o(e))a.indexOf(s)<0&&i.call(e,s)&&(t[s]=e[s]);return t})(a,["daterange"]),[p,d]=Array.isArray(t)?t:[null,null];Object.assign(k,n(l({},s),{startTime:p,endTime:d})),y()},X=(e,a)=>{switch(e.key){case"permission":ae(a);break;case"edit":G("edit",a);break;case"delete":te(a)}},ae=e=>{p.value=!0,d.value=e},te=e=>{q.confirm(`确定删除角色"${e.roleName}"吗？此操作不可恢复！`,"删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{D.success("删除成功"),I()}).catch(()=>{D.info("已取消删除")})};return(e,o)=>{const r=H,i=M,l=F,n=U,y=R,k=S("ripple");return h(),f("div",ee,[V(x(K,{modelValue:v(a),"onUpdate:modelValue":o[0]||(o[0]=e=>E(a)?a.value=e:null),onSearch:Q,onReset:v(w)},null,8,["modelValue","onReset"]),[[A,v(t)]]),x(y,{class:"art-table-card",shadow:"never",style:C({"margin-top":v(t)?"12px":"0"})},{default:b(()=>[x(l,{columns:v(u),"onUpdate:columns":o[2]||(o[2]=e=>E(u)?u.value=e:null),showSearchBar:v(t),"onUpdate:showSearchBar":o[3]||(o[3]=e=>E(t)?t.value=e:null),loading:v(j),onRefresh:v(I)},{left:b(()=>[x(i,{wrap:""},{default:b(()=>[V((h(),_(r,{onClick:o[1]||(o[1]=e=>G("add"))},{default:b(()=>[...o[6]||(o[6]=[T("新增角色",-1)])]),_:1})),[[k]])]),_:1})]),_:1},8,["columns","showSearchBar","loading","onRefresh"]),x(n,{loading:v(j),data:v(c),columns:v(m),pagination:v(g),"onPagination:sizeChange":v(O),"onPagination:currentChange":v(W)},null,8,["loading","data","columns","pagination","onPagination:sizeChange","onPagination:currentChange"])]),_:1},8,["style"]),x(Z,{modelValue:v(s),"onUpdate:modelValue":o[4]||(o[4]=e=>E(s)?s.value=e:null),"dialog-type":v(L),"role-data":v(d),onSuccess:v(I)},null,8,["modelValue","dialog-type","role-data","onSuccess"]),x($,{modelValue:v(p),"onUpdate:modelValue":o[5]||(o[5]=e=>E(p)?p.value=e:null),"role-data":v(d),onSuccess:v(I)},null,8,["modelValue","role-data","onSuccess"])])}}}));export{ae as default};
