var e=Object.defineProperty,t=Object.defineProperties,i=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,n=(t,i,r)=>i in t?e(t,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[i]=r,s=(e,t)=>{for(var i in t||(t={}))o.call(t,i)&&n(e,i,t[i]);if(r)for(var i of r(t))a.call(t,i)&&n(e,i,t[i]);return e},l=(e,t,i)=>new Promise((r,o)=>{var a=e=>{try{s(i.next(e))}catch(t){o(t)}},n=e=>{try{s(i.throw(e))}catch(t){o(t)}},s=e=>e.done?r(e.value):Promise.resolve(e.value).then(a,n);s((i=i.apply(e,t)).next())});import{d as p,a as m,e as d,f as u,p as c,u as j,z as g,F as h,$ as v,b9 as y,n as f,ba as b,aQ as x}from"./index-DxSWhjl1.js";import{E as _}from"./el-card-CxrJQUwV.js";import{_ as w}from"./index-SZqK-YiV.js";import{_ as C}from"./useTableColumns-DRhLfddV.js";import{_ as P}from"./index.vue_vue_type_script_setup_true_lang-IbCzS5fK.js";import{u as O}from"./useTable-CJG2NXTU.js";import{u as z}from"./useLayoutHeight-CW068RNu.js";import{_ as D}from"./playlist-search.vue_vue_type_script_setup_true_lang-BYoKqAav.js";import S from"./playlist-dialog-BiFvgQH8.js";import{a as T}from"./message-box-B9816q0a.js";/* empty css              *//* empty css                *//* empty css                *//* empty css                  */import"./el-option-Cunb9zja.js";import"./index-CD_r_rq4.js";import"./index-DpIcWAeA.js";import"./index-B5405CIA.js";import"./aria-Dle50h-X.js";import"./index-BdUhC8Rj.js";import"./index-B4YNvkKg.js";import"./index-BdOifhfF.js";import"./token-DWNpOE8r.js";import"./castArray-CTnnYyy2.js";import"./index-CRXlpzmM.js";import"./event-BwRzfsZt.js";import"./vnode-D3WqlgwN.js";import"./debounce-Lel90vLM.js";import"./index-BDfTIPIJ.js";/* empty css                     *//* empty css                  *//* empty css                 *//* empty css                    *//* empty css                   */import"./el-empty-BI85Vzrg.js";import"./_initCloneObject-CnmkLFFW.js";import"./el-radio-g-Zqyaif.js";import"./index-D0y5PuVQ.js";import"./_plugin-vue_export-helper-BCo6x5W8.js";/* empty css                  */import"./el-dropdown-item-BQzRcAOp.js";import"./index-Bh_mQ9x7.js";import"./refs-Cw5r5QN8.js";import"./index.vue_vue_type_script_setup_true_lang-VvwPD4Pm.js";import"./tree-select-DefJVcvz.js";import"./index-WiqLJQME.js";import"./index-Bn9cuIqS.js";import"./index-DrgPkUCe.js";import"./index-CFBlNhx4.js";import"./index-Boro3eJa.js";import"./index-DBG9R7L1.js";import"./index-baS9l8Oy.js";/* empty css                     */import"./el-row-BbFCgjqK.js";import"./el-col-ZA0CGZf_.js";import"./index-D-zLU9MD.js";import"./validator-Cq7xwYaP.js";import"./index-CJAV6PHc.js";import"./index-DqeJCCY1.js";import"./use-dialog-DNz0WzI-.js";const k={class:"playlist-page art-full-height"},F=p((R=s({},{name:"Playlist"}),t(R,i({__name:"index",setup(e){z();const t=m("add"),i=m(!1),r=m({}),o=m([]),a=m({name:void 0,username:void 0}),{columns:n,columnChecks:p,data:F,loading:R,pagination:E,getData:U,searchParams:V,resetSearchParams:I,handleSizeChange:N,handleCurrentChange:B,refreshData:H}=O({core:{apiFn:y,apiParams:s({current:1,size:20},a.value),columnsFactory:()=>[{type:"selection"},{type:"index",width:60,label:"序号"},{prop:"name",label:"歌单名称"},{prop:"description",label:"歌单描述",formatter:e=>e.description||"这个歌单没有描述"},{prop:"username",label:"创建人",width:120},{prop:"create_time",label:"创建时间",width:180,formatter:e=>{const t=new Date(e.create_time);return new Intl.DateTimeFormat("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(t)}},{prop:"update_time",label:"更新时间",width:180,formatter:e=>{const t=new Date(e.update_time);return new Intl.DateTimeFormat("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(t)}},{prop:"operation",label:"操作",width:120,fixed:"right",formatter:e=>v("div",[v(P,{type:"edit",onClick:()=>Q("edit",e)}),v(P,{type:"delete",onClick:()=>A(e)})])}]}}),L=e=>{const t=["current","size"];Object.keys(V).forEach(e=>{t.includes(e)||delete V[e]}),Object.assign(V,e),U()},Q=(e,o)=>{t.value=e,r.value=o||{},f(()=>{i.value=!0})},A=e=>{T.confirm("确定要删除该歌单吗？","删除歌单",{confirmButtonText:"确定",cancelButtonText:"取消",type:"error"}).then(()=>l(null,null,function*(){try{yield b(e.playlist_id),x.success("删除歌单成功"),U()}catch(t){x.error("删除歌单失败")}}))},J=()=>l(null,null,function*(){try{i.value=!1,r.value={},U()}catch(e){}}),M=e=>{o.value=e};return(e,o)=>{const s=C,l=w,m=_;return u(),d("div",k,[c(D,{modelValue:a.value,"onUpdate:modelValue":o[0]||(o[0]=e=>a.value=e),onSearch:L,onReset:j(I)},null,8,["modelValue","onReset"]),c(m,{class:"art-table-card",shadow:"never"},{default:g(()=>[c(s,{columns:j(p),"onUpdate:columns":o[1]||(o[1]=e=>h(p)?p.value=e:null),loading:j(R),onRefresh:j(H)},{left:g(()=>[...o[3]||(o[3]=[])]),_:1},8,["columns","loading","onRefresh"]),c(l,{loading:j(R),data:j(F),columns:j(n),pagination:j(E),onSelectionChange:M,"onPagination:sizeChange":j(N),"onPagination:currentChange":j(B)},null,8,["loading","data","columns","pagination","onPagination:sizeChange","onPagination:currentChange"]),c(S,{visible:i.value,"onUpdate:visible":o[2]||(o[2]=e=>i.value=e),type:t.value,"playlist-data":r.value,onSubmit:J},null,8,["visible","type","playlist-data"])]),_:1})])}}}))));var R;export{F as default};
